<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <title>Integrated Energy Management System</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            /* background: #011229; */
            background: #092242;
            font-family: 'Roboto';
            /* font-weight: 700;  */
        }

        .hero {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .bg-img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            display: block;
        }

        .card {
            position: absolute;
            transform-origin: center center;
            white-space: nowrap;
            text-align: center;
            color: white;
            /* background-color: #011229; */
        }

        .center-title {
            width: 100%;
            text-align: center;
            display: block;
            margin-top: 10px;
        }

        .center-status {
            width: 100%;
            text-align: center;
            display: block;
            margin: 0;
            font-size: 28px;

        }

        .card-content {
            font-size: 28px;
            display: flex;
            justify-content: space-between;
            gap: 20 px;
        }

        .card-col {
            flex: 1;
            text-align: left;
            padding-left: 10px;
            /* padding-top: 10px; */
        }

        .row-item {
            display: flex;
            gap: 10px;
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
        }

        .row-inv-input {
            margin-top: 10px;
        }

        .label {
            width: 90px;
            position: relative;
            padding-right: 20px;
        }

        .label-output {
            width: 120px;

        }

        .label-cost {
            width: 200px;
        }


        .label::after {
            content: ":";
            position: absolute;
            right: 0;
        }

        .value {
            color: #39c3e8;
        }

        .inv_input {
            margin-top: 10px;
            margin: 0;
        }

        .inv_input h3 {
            margin: 0 0 0 50px;
        }


        .inv_output {

            margin: 0;
        }

        .inv_output h4 {
            margin: 0 0 0 40px;
        }

        .sensor-card {
            display: flex;
            width: 100%;
            height: 100%;
            padding: 10px;
            color: white;
            font-family: 'Roboto', sans-serif;
            white-space: nowrap;
        }

        .sensor-col {
            flex: 1;
            padding-left: 10px;
        }

        .sensor-item {
            margin-bottom: 10px;
            line-height: 1.2;
        }

        .sensor-label {
            font-weight: 700;
            font-size: 28px;
            display: block;
        }

        .value.big {
            display: block;
            font-size: 38px;
            font-weight: 700;
            color: #39c3e8;
        }

        .sensor-icon {
            margin-top: 5px;
            display: flex;
            justify-content: center;
        }

        .icon {
            width: 80px;
            height: auto;
        }

        /* ---------- Container (posisi kiri) ---------- */
        .dropdown-container {
            position: relative;
            display: inline-block;
            margin-left: 0;
            /* pastikan di kiri */
            float: left;
            /* atau gunakan float/ flex pada parent */
        }

        /* ---------- Button ---------- */
        .dropdown-btn {
            background: linear-gradient(135deg, rgba(11, 61, 145, 0.30), rgba(30, 144, 255, 0.50));
            color: white;
            border: none;
            font-family: 'Roboto';
            padding: 12px 16px;
            font-size: 26px;
            border-radius: 0px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            user-select: none;
            width: 350px;
            /* atur lebar tombol di sini */
            height: 35px;
        }

        /* Pastikan teks label tetap di kiri dan panah selalu di ujung kanan */
        .dropdown-btn .label {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dropdown-btn .arrow {
            margin-left: auto;
            /* paksa panah ke ujung kanan */
            width: 0;
            height: 0;
            font-family: inherit;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 7px solid white;
            transition: transform 0.18s ease;
        }

        /* ketika container punya class .open, panah diputar */
        .dropdown-container.open .arrow {
            transform: rotate(180deg);
        }

        /* ---------- Menu ---------- */
        .dropdown-menu {
            display: none;
            /* di-show via JS */
            position: absolute;
            font-size: 26px;
            top: calc(100% + 8px);
            left: 0;
            /* pastikan menu muncul dari kiri tombol */
            min-width: 350px;
            /* cocokkan dengan lebar tombol */
            background: rgba(31, 104, 170, 0.65);
            /* atur transparansi di sini */
            backdrop-filter: blur(6px);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            max-height: 200px;
            /* tinggi maksimal dropdown */
            overflow-y: auto;
            /* tampilkan scroll jika item banyak */
            scrollbar-width: thin;
            /* (opsional) scrollbar tipis */
        }

        .dropdown-menu a {
            text-align: left;
            display: block;
            padding: 10px 14px;
            text-decoration: none;
            color: #fff;
            cursor: pointer;
            transition: background 0.12s ease;
        }

        .dropdown-menu a:hover,
        .dropdown-menu a.active {
            background: rgba(255, 255, 255, 0.08);
        }

        /* helper untuk show menu (JS akan menambah/menghapus inline style atau class) */
        .dropdown-container.open .dropdown-menu {
            display: block;
        }

        .icon-btn-container {
            display: flex;
            /* supaya tombol sejajar */
            /* gap: 5px; */
            /* jarak antar tombol */
            position: absolute;
            /* pakai absolute agar ikut layout card */
            left: 0;
            top: 0;
        }

        .icon-btn {
            position: relative;
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background-color: transparent;
            display: flex;
            /* supaya ikon di dalam bisa center */
            justify-content: center;
            align-items: center;
        }

        /* Hanya invert ikon, bukan tombol atau tooltip */
        .icon-btn .icon-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: brightness(0) invert(1);
            /* invert hanya untuk gambar */
        }

        /* Tooltip tetap normal */
        .icon-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #000;
            /* teks hitam tetap */
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            z-index: 999;

            filter: none;
            /* pastikan tooltip tidak terinvert */
            mix-blend-mode: normal;
            isolation: isolate;
        }

        .icon-btn:hover::after {
            opacity: 1;
        }
    </style>
    <script>
        function positionAndScaleAll() {
            const img = document.querySelector('.bg-img');
            const cards = document.querySelectorAll('.card');

            if (!img.naturalWidth) return;

            const natW = img.naturalWidth;
            const natH = img.naturalHeight;

            const dispW = img.clientWidth;
            const dispH = img.clientHeight;

            const scale = dispW / natW;

            const rect = img.getBoundingClientRect();
            const imgLeft = rect.left;
            const imgTop = rect.top;

            // LOOP semua card
            cards.forEach(card => {

                const ox = parseFloat(card.dataset.x);
                const oy = parseFloat(card.dataset.y);

                const finalX = imgLeft + (ox * scale);
                const finalY = imgTop + (oy * scale);

                card.style.left = finalX + "px";
                card.style.top = finalY + "px";
                card.style.transform = `translate(-50%, -50%) scale(${scale})`;
            });
        }

        window.onload = positionAndScaleAll;
        window.onresize = positionAndScaleAll;
    </script>
</head>

<body>

    <div class="hero">
        <img src="background.png" class="bg-img">
        <!-- CARD 1 -->
        <div class="card" data-x="285" data-y="320" style="width: 450px;height: 200px;">
            <div class="card-content">
                <div class="card-col inv_input">
                    <H3 style="text-align: center; margin: 0;">PV_1</H3>

                    <div class="row-item row-inv-input">
                        <div class="label">Voltage</div>
                        <div class="value">300.9V</div>
                    </div>

                    <div class="row-item row-inv-input">
                        <div class="label">Current</div>
                        <div class="value">0.05A</div>
                    </div>

                    <div class="row-item row-inv-input">
                        <div class="label">Power</div>
                        <div class="value">1.1W</div>
                    </div>

                </div>

                <div class="card-col" style="margin: 0;">
                    <H3 style="text-align: center; margin: 0;">PV_2</H3>

                    <div class="row-item row-inv-input">
                        <div class="label">Voltage</div>
                        <div class="value">300.9V</div>
                    </div>

                    <div class="row-item row-inv-input">
                        <div class="label">Current</div>
                        <div class="value">0.05 A</div>
                    </div>

                    <div class="row-item row-inv-input">
                        <div class="label">Power</div>
                        <div class="value">1000 W</div>
                    </div>

                </div>

            </div>
        </div>

        <!-- CARD 2 -->
        <div class="card" data-x="285" data-y="770" style="width: 450px;height: 550px;">
            <div class="center-title">
                <h1 style="margin: 0;">3 Phase AC Output</h1>
            </div>
            <div class="card-content">
                <div class="card-col inv_output">
                    <H4>L1</H4>
                    <div class="row-item">
                        <div class="label label-output">Voltage</div>
                        <div class="value">220 V</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Current</div>
                        <div class="value">0.05 A</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Power</div>
                        <div class="value">1.1 W</div>
                    </div>

                </div>
            </div>
            <div class="card-content">
                <div class="card-col inv_output">
                    <H4>L2</H4>

                    <div class="row-item">
                        <div class="label label-output">Voltage</div>
                        <div class="value">220 V</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Current</div>
                        <div class="value">0.05 A</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Power</div>
                        <div class="value">1.1 W</div>
                    </div>

                </div>
            </div>
            <div class="card-content">
                <div class="card-col inv_output">
                    <H4>L3</H4>
                    <div class="row-item">
                        <div class="label label-output">Voltage</div>
                        <div class="value">220 V</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Current</div>
                        <div class="value">0.05 A</div>
                    </div>

                    <div class="row-item">
                        <div class="label label-output">Power</div>
                        <div class="value">1.1 W</div>
                    </div>

                </div>
            </div>
            <div class="card-content">
                <div class="card-col inv_output">
                    <div class="row-item">
                        <div class="label" style="width: 240px;">Frequency</div>
                        <div class="value">220 V</div>
                    </div>

                    <div class="row-item ">
                        <div class="label" style="width: 240px;">Total Power</div>
                        <div class="value">0.05 A</div>
                    </div>

                    <div class="row-item">
                        <div class="label" style="width: 240px;">Total Energy Today</div>
                        <div class="value">1.1 W</div>
                    </div>

                </div>
            </div>
        </div>

        <!-- CARD 3 -->
        <!-- CARD 3 -->
        <div class="card" data-x="1643" data-y="326" style="width: 450px; height: 200px;">

            <div class="sensor-card">
                <div class="sensor-col">
                    <div class="sensor-item">
                        <span class="sensor-label">Temperature</span>
                        <span class="value big">30°C</span>
                    </div>

                    <div class="sensor-item">
                        <span class="sensor-label">Light Intensity</span>
                        <span class="value big">20 Lux</span>
                    </div>
                </div>

                <div class="sensor-col">
                    <div class="sensor-item">
                        <span class="sensor-label">Humidity</span>
                        <span class="value big">60%</span>
                    </div>

                    <div class="sensor-icon">
                        <img src="humidity.png" class="icon">
                    </div>
                </div>
            </div>

        </div>


        <!-- CARD 4 -->
        <div class="card" data-x="1643" data-y="605" style="width: 450px;height: 200px;">
            <div class="sensor-card">
                <div class="sensor-col">
                    <div class="sensor-item">
                        <span class="sensor-label">Voltage</span>
                        <span class="value big">220 V</span>
                    </div>

                    <div class="sensor-item">
                        <span class="sensor-label">Power</span>
                        <span class="value big">1000 W</span>
                    </div>
                </div>

                <div class="sensor-col">
                    <div class="sensor-item">
                        <span class="sensor-label">Current</span>
                        <span class="value big">20,05 A</span>
                    </div>

                    <div class="sensor-item">
                        <span class="sensor-label">Today’s Energy</span>
                        <span class="value big">100 kWh</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 5 -->
        <div class="card" data-x="1643" data-y="900" style="width: 450px;height: 200px;">

            <div class="card-content">
                <div class="card-col inv_output">


                    <div class="row-item">
                        <div class="label label-cost">Electricity rates</div>
                        <div class="value"><span>Rp</span><span>16.699</span><span>/kWh</span></div>
                    </div>

                    <div class="row-item">
                        <div class="label label-cost">Total PV Energy</div>
                        <div class="value">1.1 W</div>
                    </div>
                    <div class="center-title">
                        <h3 style="margin: 0;">Today Saving Cost</h3>
                        <h2 style="margin: 0;color: greenyellow;"><span>Rp</span><span>110.000.699</span></h1>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 4 -->
        <div class="card" data-x="970" data-y="420" style="width: 850px;height: 550px;">

            <iframe src="../../template/energi/3d" style="width:100%; height:100%; border:none;"></iframe>
        </div>

        <!-- CARD 6 -->
        <div class="card" data-x="960" data-y="905" style="width: 860px;height: 310px;">
            <div class="card-content">
                <div id="container" style="width:100%; height:100%; min-height:300px; "></div>
            </div>
        </div>

        <!-- Status inverter -->
        <div class="card" data-x="400" data-y="205" style="width: 150px;height: 40px;">

            <div class="center-status">
                <span style="color: greenyellow;">Online</span>
            </div>
        </div>

        <!-- Status Sensor -->
        <div class="card" data-x="1770" data-y="210" style="width: 150px;height: 40px;">

            <div class="center-status">
                <span style="color: greenyellow;">Online</span>
            </div>
        </div>
    </div>
    <!-- Date Time -->
    <div class="card" data-x="1480" data-y="110" style="width: 150px;height: 40px;">
        <div id="waktu" style="font-size: 35px; color: white; font-weight: bold;"></div>
    </div>
    <div class="card" data-x="800" data-y="728" style="width: 350px;height: 40px;">
        <div class="dropdown-container" id="dropdown">
            <button class="dropdown-btn" id="dropdownBtn">
                Voltage Inverter Input
                <span class="arrow"></span>
            </button>

            <div class="dropdown-menu" id="dropdownMenu">
                <!-- Inverter INPUT -->
                <a data-key="voltage_inverter_input">Voltage Inverter Input</a>
                <a data-key="current_inverter_input">Current Inverter Input</a>
                <a data-key="power_inverter_input">Power Inverter Input</a>

                <!-- Inverter OUTPUT -->
                <a data-key="voltage_inverter_output">Voltage Inverter Output</a>
                <a data-key="current_inverter_output">Current Inverter Output</a>
                <a data-key="power_inverter_output">Power Inverter Output</a>
                <a data-key="total_power_inverter_output">Total Power Inverter Output</a>

                <!-- Sensor Class -->
                <a data-key="temperature_class_sensor">Temperature Class Sensor</a>
                <a data-key="humidity_class_sensor">Humidity Class Sensor</a>
                <a data-key="light_intensity_class_sensor">Light Intensity Class Sensor</a>

                <!-- Energy Class -->
                <a data-key="voltage_class_energy">Voltage Class Energy</a>
                <a data-key="current_class_energy">Current Class Energy</a>
                <a data-key="power_class_energy">Power Class Energy</a>
            </div>
        </div>
    </div>
    <div class="card" data-x="1330" data-y="728" style="width: 100px;height: 40px;">
        <div class="icon-btn-container">
            <a id="download" class="icon-btn" data-tooltip="Download" href="#">
                <img src="./src/img/download.png" class="icon-img">
            </a>

            <a id="fullScreen" class="icon-btn" data-tooltip="fullScreen" >
                <img src="./src/img/link.png" style="height: 25px;" class="icon-img">
            </a>
        </div>
    </div>
    <div id="exportChart" style="width:1600px;height:900px;
            position:fixed;left:-9999px;top:-9999px;"></div>

</body>

<script>
    const dom = document.getElementById('container');
    const domExport = document.getElementById('exportChart');
    const myChart = echarts.init(dom, 'light', { renderer: 'svg' });
    const exportChart = echarts.init(domExport, 'light', { renderer: 'canvas' });

    const baseOption = {
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            bottom: 0,
            textStyle: { color: '#fff', fontSize: 28, fontWeight: 'bold' }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '10%',
            top: '8%',
            containLabel: true
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            axisLine: { lineStyle: { color: '#fff', width: 4 } },
            axisLabel: { color: '#fff', fontSize: 16, rotate: 45 }
        },
        yAxis: {
            type: 'value',
            axisLine: { lineStyle: { color: '#fff', width: 4 } },
            splitLine: { lineStyle: { color: '#fff' } }
        },
        series: []
    };

    myChart.setOption(baseOption);
    window.addEventListener('resize', myChart.resize);
    exportChart.setOption(baseOption);
    window.addEventListener('resize', exportChart.resize);

</script>
<script>
    let dashboardData = null;

    fetch('./data/dashboard_data.json')
        .then(res => res.json())
        .then(data => {
            dashboardData = data;
            loadChart('voltage_inverter_input'); // default
        })
        .catch(err => console.error('Load JSON gagal:', err));
</script>

<script>
    function padTo24(dataArray) {
        const result = [...dataArray];
        while (result.length < 24) {
            result.push(null);
        }
        return result.slice(0, 24);
    }
    function normalizeSeriesOnly(seriesObj) {
        const out = {};
        for (const key in seriesObj) {
            out[key] = padTo24(seriesObj[key]);
        }
        return out;
    }

</script>
<script>
    function formatTanggal() {
        const now = new Date();
        return now.toLocaleString('id-ID', {
            day: '2-digit',
            month: 'long',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
    }
    var setTitle = "";
    var setUnit = "";
    function loadChart(key) {
        if (!dashboardData || !dashboardData[key]) return;

        const cfg = dashboardData[key];
        const paddedSeries = normalizeSeriesOnly(cfg.series);
        console.log(paddedSeries);
        setTitle = cfg.title;
        setUnit = cfg.unit;

        const series = Object.entries(paddedSeries).map(([name, data]) => ({
            name,
            type: 'line',
            smooth: true,
            data,
            lineStyle: { width: 3 },
            connectNulls: false
        }));

        myChart.setOption({
            title: {
                text: '',
            },
            color: [
                '#00E5FF',
                'greenyellow',
                '#FF5252'
            ],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    label: {
                        backgroundColor: '#333'
                    }
                },
                confine: true,
                backgroundColor: 'rgba(0,0,0,0.7)',
                textStyle: {
                    fontSize: 16,
                    color: '#fff'
                },
                formatter: function (params) {
                    let html = `<b>Jam ${params[0].axisValue}</b><br/>`;

                    params.forEach(p => {
                        if (p.data !== null) {
                            html += `
                <span style="color:${p.color}">●</span>
                ${p.seriesName}: <b>${p.data} ${cfg.unit}</b><br/>
            `;
                        }
                    });

                    return html;
                }

            }
            ,
            legend: {
                data: Object.keys(paddedSeries),
                textStyle: {
                    fontSize: 30,
                    color: '#ffff',
                    fontWeight: 'bold',

                },
                bottom: 0
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '10%',
                top: '5%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: null
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                axisLine: {
                    show: true,          // pastikan garis Y-axis tampil
                    lineStyle: {
                        width: 5,
                        color: '#ffff'
                    }
                },
                data: [
                    "00.00", "01.00", "02.00", "03.00", "04.00", "05.00",
                    "06.00", "07.00", "08.00", "09.00", "10.00", "11.00",
                    "12.00", "13.00", "14.00", "15.00", "16.00", "17.00",
                    "18.00", "19.00", "20.00", "21.00", "22.00", "23.00"
                ],
                axisLabel: {
                    fontSize: 16,      // Ubah ukuran font di sini
                    color: '#ffff',      // (opsional) warna teks
                    rotate: 45,          // (opsional) rotasi teks
                    fontWeight: 'bold'  // (opsional)
                }
            },
            yAxis: {


                type: 'value',
                min: function (value) {
                    return value.min;
                },
                axisLabel: {
                    fontSize: 16,      // Ubah ukuran font di sini
                    color: '#ffff',      // (opsional) warna teks
                    rotate: 45,          // (opsional) rotasi teks
                    fontWeight: 'bold'  // (opsional)
                },
                splitLine: {
                    show: true,            // tampilkan garis
                    lineStyle: {
                        width: 1,
                        type: 'solid',      // solid | dashed | dotted
                        color: '#ffff'
                    }
                },

                axisLine: {
                    show: true,          // pastikan garis Y-axis tampil
                    lineStyle: {
                        width: 5,
                        color: '#ffff'
                    }
                },
            },
            series
        }, true);
        exportChart.setOption({
            title: {
                text: cfg.title + ' (' + setUnit + ')',
                subtext: formatTanggal(),
                top: 'top',
                left: 'center',
                textStyle: {
                    fontSize: 32,
                    fontWeight: 'bold',
                    color: '#000'
                },
                subtextStyle: {
                    fontSize: 16,
                    color: '#444'
                }
            },
            color: [
                '#00E5FF',
                'greenyellow',
                '#FF5252'
            ],

            legend: {
                data: Object.keys(paddedSeries),
                textStyle: {
                    fontSize: 30,
                    color: '#000000',
                    fontWeight: 'bold',

                },
                bottom: 0
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '10%',
                top: '10%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: null
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                axisLine: {
                    show: true,          // pastikan garis Y-axis tampil
                    lineStyle: {
                        width: 5,
                        color: '#000000'
                    }
                },
                data: [
                    "00.00", "01.00", "02.00", "03.00", "04.00", "05.00",
                    "06.00", "07.00", "08.00", "09.00", "10.00", "11.00",
                    "12.00", "13.00", "14.00", "15.00", "16.00", "17.00",
                    "18.00", "19.00", "20.00", "21.00", "22.00", "23.00"
                ],
                axisLabel: {
                    fontSize: 16,      // Ubah ukuran font di sini
                    color: '#000000',      // (opsional) warna teks
                    rotate: 45,          // (opsional) rotasi teks
                    fontWeight: 'bold'  // (opsional)
                }
            },
            yAxis: {

                type: 'value',
                min: function (value) {
                    return value.min;
                },
                axisLabel: {
                    fontSize: 16,      // Ubah ukuran font di sini
                    color: '#000000',      // (opsional) warna teks
                    rotate: 45,          // (opsional) rotasi teks
                    fontWeight: 'bold'  // (opsional)
                },
                splitLine: {
                    show: true,            // tampilkan garis
                    lineStyle: {
                        width: 1,
                        type: 'solid',      // solid | dashed | dotted
                        color: '#000000'
                    }
                },

                axisLine: {
                    show: true,          // pastikan garis Y-axis tampil
                    lineStyle: {
                        width: 5,
                        color: '#000000'
                    }
                },
            },
            series
        }, true);
    }
</script>




<script>
    function updateTime() {
        const now = new Date();

        // Ambil waktu
        const jam = String(now.getHours()).padStart(2, '0');
        const menit = String(now.getMinutes()).padStart(2, '0');
        const detik = String(now.getSeconds()).padStart(2, '0');

        // Format tanggal Indonesia
        const namaBulan = [
            "Januari", "Februari", "Maret", "April", "Mei", "Juni",
            "Juli", "Agustus", "September", "Oktober", "November", "Desember"
        ];

        const tanggal = now.getDate();
        const bulan = namaBulan[now.getMonth()];
        const tahun = now.getFullYear();

        // Gabungkan hasil
        const tampil = `${jam}:${menit}:${detik}, ${tanggal} ${bulan} ${tahun}`;

        document.getElementById('waktu').textContent = tampil;
        return tampil;
    }

    // Update setiap 1 detik
    setInterval(updateTime, 1000);

    // Panggilan awal
    updateTime();
</script>
<script>
    const dropdown = document.getElementById("dropdown");
    const btn = document.getElementById("dropdownBtn");
    const menu = document.getElementById("dropdownMenu");
    const items = menu.querySelectorAll("a");

    btn.addEventListener("click", function () {
        const isOpen = dropdown.classList.contains("open");
        dropdown.classList.toggle("open", !isOpen);
        menu.style.display = isOpen ? "none" : "block";
    });

    items.forEach(item => {
        item.addEventListener("click", function () {
            btn.childNodes[0].textContent = this.textContent.trim(); + " ";
            dropdown.classList.remove("open");
            menu.style.display = "none";
        });
    });

    // Tutup jika klik area luar
    document.addEventListener("click", function (e) {
        if (!dropdown.contains(e.target)) {
            dropdown.classList.remove("open");
            menu.style.display = "none";
        }
    });
</script>
<script>

    items.forEach(item => {
        item.addEventListener("click", function () {
            const key = this.dataset.key;
            const label = this.textContent.trim();

            btn.childNodes[0].textContent = label + " ";
            dropdown.classList.remove("open");
            menu.style.display = "none";

            loadChart(key);
        });
    });

    document.getElementById("download").onclick = () => {
        const url = exportChart.getDataURL({
            type: 'png',
            pixelRatio: 2,
            backgroundColor: '#fff'
        });

        const a = document.createElement("a");
        a.href = url;
        a.download = setTitle.replace(/ /g, "_") + "_" + updateTime().replace(/:/g, "").replace(/,/g, "").replace(/ /g, "_") + ".png";
        a.click();
    };
    document.getElementById("fullScreen").onclick = () => {
        document.getElementById("container").requestFullscreen();
    };

</script>






</html>